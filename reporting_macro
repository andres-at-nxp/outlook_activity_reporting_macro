Sub ThisOultookSession()
  Dim oFld As Outlook.MAPIFolder
  Dim oItems As Outlook.Items
  Dim sFind As String
  Dim obj As Object
  Dim i As Long
  Dim j As Long
  Dim iDate As Long
  Dim iCat As Long
  Dim startDate As Date
  Dim endDate As Date
  Dim DateLength As Long
  Dim Categories() As String
  Dim TimeCount() As Long
  Dim Matrix() As Variant
  
  Dim Exists As Boolean
  Dim wb As Excel.Workbook
  Dim destination As Range

  
  startDate = Date - Weekday(Date) + 1
  endDate = Date - Weekday(Date) + 7
  DateLength = endDate - startDate
  ReDim Categories(0)
  ReDim Matrix(DateLength, 1)

  Set oFld = Application.Session.GetDefaultFolder(olFolderCalendar)
  Set oItems = oFld.Items

  oItems.Sort "[Start]", False
  oItems.IncludeRecurrences = True
    
  dtDate = startDate
  iDate = 0
  
  Do While dtDate <= endDate
    Matrix(iDate, 0) = dtDate
    sFind = Format(dtDate, "ddddd")

    sFind = "[Start] <= " & _
                Chr(34) & sFind & " 11:59 PM" & Chr(34) & _
                " AND [End] > " & _
                Chr(34) & sFind & " 12:00 AM" & Chr(34)

    Set oDay = oItems.Restrict(sFind)
    For Each meeting In oDay
        i = i + 1
        j = 0
        Exists = False
        For Each cat In Categories
            If cat = meeting.Categories Then
                Exists = True
            End If
            If Exists = False Then
                j = j + 1
            End If
        Next cat
        If Exists = False Then
            ReDim Preserve Categories(UBound(Categories) + 1)
            ReDim Preserve Matrix(DateLength, UBound(Categories) + 1)
            Categories(j) = meeting.Categories
        End If
        Matrix(iDate, j + 1) = Matrix(iDate, j + 1) + (meeting.Duration / 60)
    Next
    dtDate = dtDate + 1
    iDate = iDate + 1
  Loop

  Set objExcel = New Excel.Application
  objExcel.Visible = True
  Set wb = objExcel.Workbooks.Add

  With wb
    .Activate
    
    ' 1
    .Worksheets(1).Range("A1").Value = "Category"
    Set destination = .Worksheets(1).Range("A2")
    Set destination = destination.Resize(UBound(Categories), 1)
    destination.Value = Excel.Application.Transpose(Categories)
    '2
    Set destination = .Worksheets(1).Range("B1")
    Set destination = destination.Resize(UBound(Categories) + 1, DateLength + 1)
    destination.Value = Excel.Application.Transpose(Matrix)

  End With
  
End Sub
